DROP TABLE EMPLOYEES;
DROP TABLE LOGIN;
DROP TABLE REQUEST;

CREATE TABLE EMPLOYEES(
EMP_ID NUMBER(8,0) PRIMARY KEY,
FIRST_NAME VARCHAR2 (20) NOT NULL,
LAST_NAME VARCHAR2 (20) NOT NULL,
REPORTS_TO NUMBER (8,0) NOT NULL
)
/
CREATE TABLE LOGIN(
EMP_ID NUMBER (8,0) PRIMARY KEY,
USERNAME VARCHAR2 (20) NOT NULL,
UPASSWORD VARCHAR2 (20) NOT NULL
)
/
CREATE TABLE REQUEST(
REQ_ID NUMBER (8,0) PRIMARY KEY,
EMP_ID NUMBER (8,0) NOT NULL,
EMT NUMBER (10,2) NOT NULL,
IMAGE BLOB,
STATUS VARCHAR2 (10) DEFAULT ('Pending'),
CATAGORY VARCHAR2 (20),
DETAILS VARCHAR2 (100)
)
/
ALTER TABLE REQUEST
    ADD CONSTRAINT FK_EMP_ID 
    FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEES(EMP_ID)
    ON DELETE CASCADE;
/
CREATE SEQUENCE EMP_SEQ;
/
CREATE SEQUENCE REQ_SEQ;
/
CREATE OR REPLACE TRIGGER EMP_ON_INSERT
    BEFORE INSERT ON EMPLOYEES
    FOR EACH ROW
    BEGIN
        SELECT EMP_SEQ.NEXTVAL
        INTO :NEW.EMP_ID
        FROM DUAL;
    END;
/
CREATE OR REPLACE TRIGGER REQ_ON_INSERT
    BEFORE INSERT ON REQUEST
    FOR EACH ROW
    BEGIN
        SELECT REQ_SEQ.NEXTVAL
        INTO :NEW.REQ_ID
        FROM DUAL;
    END;
/
